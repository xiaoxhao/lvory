# Mihomo é«˜çº§é…ç½®ç¤ºä¾‹
# åŒ…å« TUN æ¨¡å¼ã€è§„åˆ™é›†ã€ä»£ç†æä¾›è€…ç­‰é«˜çº§åŠŸèƒ½

# åŸºç¡€é…ç½®
mixed-port: 7890
allow-lan: false
mode: rule
log-level: info
external-controller: 127.0.0.1:9090
secret: ""                    # API å¯†é’¥ï¼ˆå¯é€‰ï¼‰

# å…¨å±€é…ç½®
global-client-fingerprint: chrome

# TUN æ¨¡å¼é…ç½®
tun:
  enable: true
  stack: system               # system/gvisor/lwip
  dns-hijack:
    - any:53
  auto-route: true
  auto-detect-interface: true

# é«˜çº§ DNS é…ç½®
dns:
  enable: true
  listen: 0.0.0.0:53
  ipv6: false
  use-hosts: true
  enhanced-mode: fake-ip      # redir-host/fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - '*.lan'
    - localhost.ptlogin2.qq.com
    - '+.srv.nintendo.net'
    - '+.stun.playstation.net'
    - xbox.*.microsoft.com
    - '*.battlenet.com.cn'
    - '*.wotgame.cn'
    - '*.wggames.cn'
    - '*.wowsgame.cn'
    - '*.wargaming.net'
  default-nameserver:
    - 223.5.5.5
    - 8.8.8.8
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
  fallback:
    - https://cloudflare-dns.com/dns-query
    - https://dns.google/dns-query
  fallback-filter:
    geoip: true
    geoip-code: CN
    ipcidr:
      - 240.0.0.0/4

# ä»£ç†æä¾›è€…ï¼ˆä»å¤–éƒ¨ URL è·å–èŠ‚ç‚¹ï¼‰
proxy-providers:
  provider1:
    type: http
    url: "https://example.com/clash/config"
    interval: 3600
    path: ./providers/provider1.yaml
    health-check:
      enable: true
      interval: 600
      url: http://www.gstatic.com/generate_204

# è§„åˆ™æä¾›è€…ï¼ˆä»å¤–éƒ¨ URL è·å–è§„åˆ™ï¼‰
rule-providers:
  reject:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/reject.txt"
    path: ./ruleset/reject.yaml
    interval: 86400

  icloud:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/icloud.txt"
    path: ./ruleset/icloud.yaml
    interval: 86400

  apple:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/apple.txt"
    path: ./ruleset/apple.yaml
    interval: 86400

  google:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/google.txt"
    path: ./ruleset/google.yaml
    interval: 86400

  proxy:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/proxy.txt"
    path: ./ruleset/proxy.yaml
    interval: 86400

  direct:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/direct.txt"
    path: ./ruleset/direct.yaml
    interval: 86400

  private:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/private.txt"
    path: ./ruleset/private.yaml
    interval: 86400

  gfw:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/gfw.txt"
    path: ./ruleset/gfw.yaml
    interval: 86400

  telegramcidr:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/telegramcidr.txt"
    path: ./ruleset/telegramcidr.yaml
    interval: 86400

  cncidr:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt"
    path: ./ruleset/cncidr.yaml
    interval: 86400

  lancidr:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/lancidr.txt"
    path: ./ruleset/lancidr.yaml
    interval: 86400

# ä»£ç†èŠ‚ç‚¹ï¼ˆç¤ºä¾‹ï¼‰
proxies:
  - name: "ss-01"
    type: ss
    server: server1.example.com
    port: 443
    cipher: aes-256-gcm
    password: "password1"

  - name: "vmess-01"
    type: vmess
    server: server2.example.com
    port: 443
    uuid: 12345678-1234-1234-1234-123456789abc
    alterId: 0
    cipher: auto
    tls: true

# ä»£ç†ç»„é…ç½®
proxy-groups:
  - name: "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
    type: select
    proxies:
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
      - ğŸ¯ å…¨çƒç›´è¿
      - ğŸ›‘ å…¨çƒæ‹¦æˆª
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
      - ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹

  - name: "â™»ï¸ è‡ªåŠ¨é€‰æ‹©"
    type: url-test
    use:
      - provider1
    url: 'http://www.gstatic.com/generate_204'
    interval: 300
    tolerance: 50

  - name: "ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹"
    type: url-test
    filter: "(?i)æ¸¯|hk|hongkong|hong kong"
    use:
      - provider1
    url: 'http://www.gstatic.com/generate_204'
    interval: 300
    tolerance: 50

  - name: "ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹"
    type: url-test
    filter: "(?i)ç¾|us|unitedstates|united states"
    use:
      - provider1
    url: 'http://www.gstatic.com/generate_204'
    interval: 300
    tolerance: 50

  - name: "ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹"
    type: url-test
    filter: "(?i)æ–°åŠ å¡|å¡|sg|singapore"
    use:
      - provider1
    url: 'http://www.gstatic.com/generate_204'
    interval: 300
    tolerance: 50

  - name: "ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹"
    type: url-test
    filter: "(?i)æ—¥æœ¬|jp|japan"
    use:
      - provider1
    url: 'http://www.gstatic.com/generate_204'
    interval: 300
    tolerance: 50

  - name: "ğŸ“º å“”å“©å“”å“©"
    type: select
    proxies:
      - ğŸ¯ å…¨çƒç›´è¿
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹

  - name: "ğŸ® æ¸¸æˆå¹³å°"
    type: select
    proxies:
      - ğŸ¯ å…¨çƒç›´è¿
      - ğŸš€ èŠ‚ç‚¹é€‰æ‹©
      - ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹

  - name: "ğŸ¯ å…¨çƒç›´è¿"
    type: select
    proxies:
      - DIRECT

  - name: "ğŸ›‘ å…¨çƒæ‹¦æˆª"
    type: select
    proxies:
      - REJECT

# è§„åˆ™é…ç½®
rules:
  - RULE-SET,private,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,reject,ğŸ›‘ å…¨çƒæ‹¦æˆª
  - RULE-SET,icloud,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,apple,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,google,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - RULE-SET,proxy,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - RULE-SET,direct,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,lancidr,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,cncidr,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,telegramcidr,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - GEOIP,LAN,ğŸ¯ å…¨çƒç›´è¿
  - GEOIP,CN,ğŸ¯ å…¨çƒç›´è¿
  - MATCH,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
